<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="css/App.css" rel="stylesheet" />
    <link href="css/Header.css" rel="stylesheet" />
    <link href="css/Editor.css" rel="stylesheet" />
    <link href="css/List.css" rel="stylesheet" />
    <link href="css/TodoItem.css" rel="stylesheet" />
    <title>document</title>
  </head>
  <body>
    <div class="App">
      <div class="Header">
        <h3>ì˜¤ëŠ˜ì˜ Plan ğŸ˜Š</h3>
        <h1 id="today"></h1>
      </div>

      <form>
        <div class="Editor">
          <input type="text" placeholder="ìƒˆë¡œìš´ todo" />
          <button>ì¶”ê°€</button>
        </div>
      </form>

      <div class="List">
        <h4>Todo List ğŸŒ´</h4>
        <input type="text" id="keyword" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”." />

        <div class="todos_wrapper"></div>
      </div>
    </div>

    <script>
      let mockData = [
        {
          id: 0,
          isDone: false,
          content: "React study",
          date: new Date().getTime(),
        },
        {
          id: 1,
          isDone: true,
          content: "ì¹œêµ¬ë§Œë‚˜ê¸°",
          date: new Date().getTime(),
        },
        {
          id: 2,
          isDone: false,
          content: "ë‚®ì ìê¸°",
          date: new Date().getTime(),
        },
      ];

      let day = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];

      // 1. í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ onload ì´ë²¤íŠ¸ê°€ ë°œìƒí•©ë‹ˆë‹¤.(í˜„ì¬ ë‚ ì§œ)
      onload = () => {
        initData(mockData); // ì´ˆê¸° í™”ë©´ì— todo ë¦¬ìŠ¤íŠ¸ ì¶œë ¥

        const today = new Date(); // ë‚ ì§œì™€ ì‹œê°„ì„ ë‹¤ë£¨ê¸° ìœ„í•œ ë‚´ì¥ ê°ì²´
        // today.getFullYear()ë§Œ í•˜ë©´ ìˆ«ìë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. sliceëŠ” ë¬¸ìì—´, ë°°ì—´ì—ë§Œ ì‚¬ìš©ê°€ëŠ¥í•´ String
        const year = String(today.getFullYear()).slice(2); // 2025 â†’ '25'
        const month = today.getMonth() + 1;
        const date = today.getDate();
        // Date ê°ì²´ì˜ getDay() ë©”ì„œë“œëŠ” í˜„ì¬ ë‚ ì§œì˜ ìš”ì¼ì„ ìˆ«ìë¡œ ë°˜í™˜
        const dayStr = day[today.getDay()];

        const todayStr = `${year}ë…„ ${month}ì›” ${date}ì¼ ${dayStr}ìš”ì¼`;
        document.getElementById("today").innerText = todayStr;
      };

      // 2. ì „ì²´ ì¶œë ¥ ê¸°ëŠ¥(initData í•¨ìˆ˜)
      // initDataëŠ” printData(ì¦‰, mockData)ë¥¼ ë°›ì•„ ë°°ì—´ì˜ ê° todo ê°ì²´ë¥¼ ì²˜ë¦¬.
      const initData = (printData) => {
        const wrapper = document.querySelector(".todos_wrapper"); // ì¶œë ¥í•  ìœ„ì¹˜ë¥¼ ì„ íƒ
        wrapper.innerHTML = ""; // ê¸°ì¡´ ëª©ë¡ì„ ë¹„ì›Œì¤ë‹ˆë‹¤.

        // mockDataì•ˆì˜ ê° ê°ì²´ë¥¼ í•˜ë‚˜ì”© ëŒì•„ë´…ë‹ˆë‹¤.
        printData.forEach((todo) => {
          // "ë°€ë¦¬ì´ˆ(ms)" ë‹¨ìœ„ë¡œ ë‚˜íƒ€ë‚¸ ìˆ«ì timeStapë¥¼ Date ê°ì²´ë¥¼ ì´ìš©í•´ ë‚ ì§œë¡œ ë°”ê¿”ì¤ë‹ˆë‹¤.
          // 1746126600000 ì´ë ‡ê²Œ ë‚˜ì˜¤ëŠ” ê²ƒì„ Date ê°ì²´ë¡œ ë³€í™˜í•´ ë‚ ì§œ/ì‹œê°„ ì •ë³´ë¥¼ ì¶”ì¶œ
          const dateObj = new Date(todo.date);

          const year = dateObj.getFullYear(); // ë‚ ì§œ ê°ì²´ì—ì„œ ì—°ë„(ì˜ˆ: 2025)ë¥¼ ì¶”ì¶œ
          const month = dateObj.getMonth() + 1; // getMonth()ëŠ” 0ë¶€í„° ì‹œì‘í•˜ëŠ” ì›”ì„ ë°˜í™˜í•´ +1 í•´ì£¼ê¸°
          const date = dateObj.getDate();
          const dayStr = day[dateObj.getDay()]; // getDay()ëŠ” ìš”ì¼ì„ ìˆ«ìë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. (0: ì¼ìš”ì¼, 1: ì›”ìš”ì¼, ..., 6: í† ìš”ì¼)

          let hour = dateObj.getHours(); // ì‹œê°„ì„ 24ì‹œê°„ì œ ê¸°ì¤€ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤. (0~23)
          // getMinutes()ì™€ getSeconds()ë¡œ ë¶„ê³¼ ì´ˆë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
          // padStart(2, "0")ëŠ” í•œ ìë¦¬ ìˆ«ìì¼ ë•Œ ì•ì— 0ì„ ë¶™ì—¬ì„œ ë‘ ìë¦¬ë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤
          const minutes = String(dateObj.getMinutes()).padStart(2, "0");
          const seconds = String(dateObj.getSeconds()).padStart(2, "0");

          const ampm = hour < 12 ? "ì˜¤ì „" : "ì˜¤í›„";
          // 12ì‹œê°„ì œ í‘œê¸°ë¡œ ë°”ê¾¸ê¸° ìœ„í•œ ì½”ë“œ
          hour = hour % 12 === 0 ? 12 : hour % 12;

          // ì§€ê¸ˆê¹Œì§€ ë§Œë“  ë‚ ì§œ/ì‹œê°„ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ ì¡°í•©í•´ í‘œì‹œìš© í˜•ì‹ì„ ë§Œë“­ë‹ˆë‹¤.
          const viewDate = `${year}.${month}.${date}. ${ampm} ${hour}:${minutes}:${seconds}`;

          const todoEl = `
            <div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(${todo.id})" ${
            todo.isDone ? "checked" : ""
          } />
                <div class="content">${todo.content}</div>
                <div class="date">${viewDate}</div>
                <button class="button" name="del" value="${
                  todo.id
                }" onclick="todoDel(this)">ì‚­ì œ</button>
            </div>`;

          // ì™„ì„±ëœ todoEl HTML ë¬¸ìì—´ì„ ê¸°ì¡´ wrapper ìš”ì†Œì˜ innerHTMLì— ì¶”ê°€
          wrapper.innerHTML += todoEl;
        });
      };

      // 3. ì¶”ê°€ ê¸°ëŠ¥

      let idIndex = 3;
      // ìì‹ ì„ íƒìëŠ” ì§ì ‘ì ì¸ ìì‹ ìš”ì†Œë¥¼ ì„ íƒí•˜ëŠ”ë° ì‚¬ìš©ë˜ë©° ê·¸ ì™¸ëŠ” ì„ íƒë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
      document.querySelector(".Editor > button").onclick = (event) => {
        event.preventDefault(); // ê¸°ë³¸ í¼ ì œì¶œ ë™ì‘ ë§‰ëŠ” ì—­í• 

        const input = document.querySelector(".Editor > input");
        // input.valueëŠ” ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì„ ê°€ì ¸ì˜¤ë©° trimì€ ì• ë’¤ ê³µë°±ì„ ì œê±°í•©ë‹ˆë‹¤.
        const content = input.value.trim();

        if (content === "") {
          alert("ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
          return;
        }

        // ìƒˆë¡œìš´ í•  ì¼ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
        const newTodo = {
          id: idIndex++, // ê³ ìœ í•œ ì•„ì´ë””ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.
          isDone: false, // ìƒˆë¡œ ì¶”ê°€ëœ í•  ì¼ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¯¸ì™„ë£Œ ìƒíƒœ
          content: content, // ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë‚´ìš©ì„ content ì†ì„±ì— ì €ì¥
          date: new Date().getTime(), // í˜„ì¬ ì‹œê°„ì„ date ì†ì„±ì— ì €ì¥
        };

        mockData.push(newTodo); // ë°°ì—´ì— ì¶”ê°€
        input.value = ""; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
        initData(mockData); // í™”ë©´ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
      };

      // ìˆ˜ì • ê¸°ëŠ¥ -> mockData ë°°ì—´ì„ ë³€ê²½ëœ ìƒˆ ë°°ì—´ë¡œ ë§¤í•‘
      const onUpdate = (targetId) => {
        mockData = mockData.map((todo) =>
          todo.id === targetId ? { ...todo, isDone: !todo.isDone } : todo
        );
        initData(mockData); // ìˆ˜ì •ëœ mockData ë°°ì—´ì„ ê¸°ë°˜ìœ¼ë¡œ í™”ë©´ì„ ë‹¤ì‹œ ì¶œë ¥
      };

      // ì‚­ì œ ê¸°ëŠ¥
      const todoDel = (th) => {
        const id = Number(th.value); // ì‚­ì œí•  id
        mockData = mockData.filter((todo) => todo.id !== id); // í•´ë‹¹ id ì œì™¸í•˜ê³  í•„í„°ë§
        initData(mockData); // ë‹¤ì‹œ ì¶œë ¥
      };

      // ê²€ìƒ‰ ê¸°ëŠ¥
      // idê°€ keywordì¸ input ìš”ì†Œë¥¼ ì„ íƒ
      // .onkeyup: ì‚¬ìš©ìê°€ í‚¤ë³´ë“œë¥¼ ëˆŒë €ë‹¤ê°€ ë—ì„ ë•Œ(keyup ì´ë²¤íŠ¸)ì— ì‹¤í–‰ë  í•¨ìˆ˜ë¥¼ ë“±ë¡
      // getFilterData(...): ì´ ê²€ìƒ‰ì–´ë¥¼ ì¸ìë¡œ ì „ë‹¬í•´ì„œ mockDataë¥¼ í•„í„°ë§í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰
      // searchedTodos: í•„í„°ë§ëœ ê²°ê³¼(ê²€ìƒ‰ì— í•´ë‹¹í•˜ëŠ” todo í•­ëª©ë“¤)ë¥¼ ì €ì¥
      document.querySelector("#keyword").onkeyup = (e) => {
        const searchedTodos = getFilterData(e.target.value);
        initData(searchedTodos);
      };

      // search: ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´ê°€ ì´ í•¨ìˆ˜ì— ì „ë‹¬
      // ê²€ìƒ‰ì–´ê°€ ê³µë°±ì´ë©´ ì „ì²´ ë°˜í™˜
      // (todo) => todo.content.includes(...): ê° todo í•­ëª©ì˜ content ì†ì„±(í•  ì¼ ë‚´ìš©)ì´ ê²€ìƒ‰ì–´ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ”ì§€ ê²€ì‚¬
      const getFilterData = (search) => {
        if (search.trim() === "") return mockData;
        return mockData.filter((todo) => todo.content.includes(search.trim()));
      };
    </script>
  </body>
</html>
